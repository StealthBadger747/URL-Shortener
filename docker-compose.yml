version: "3"
services:
  url-shortener:
    build: .
    image: url-shortener
    ports:
      - "8080:8080"
    environment:
      - SERVER_PORT=8080
      - FRONTEND_DIR=/app/static
      - DATABASE_PATH=/data/url-shortener.db
      # Optional password gate for /api/shorten_url
      # - SHORTEN_PASSWORD=change-me
      # Optional Cap bot filtering (requires cap service)
      # - CAP_SITEVERIFY_URL=http://cap:3000/siteverify
      # - CAP_SECRET=change-me
      # - CAP_API_ENDPOINT=http://cap:3000
    volumes:
      - ./data:/data

  # Optional Cap bot filtering service
  # cap:
  #   image: tiagozip/cap:latest
  #   networks:
  #     - url-shortener-network
  #   environment:
  #     - CAP_SECRET=change-me

# networks:
#   url-shortener-network:
#     driver: bridge
